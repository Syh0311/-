<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

</body>
<script>
  // 来自https://juejin.cn/post/6844903496550989837


  // 2.WebWorker线程——————————————————————————————————————
  var myTask = `
   //Step2. WebWorker线程【接受】数据
    onmessage = function (e) {
        var data = e.data;
        data.push('hello');
        console.log('worker:', data); // worker: [1, 2, 3, "hello"]
   //Step3. WebWorker线程【发送】数据
        postMessage(data);
    };
`;
  // 1.本地线程——————————————————————————————————————
  var blob = new Blob([myTask]);
  var myWorker = new Worker(window.URL.createObjectURL(blob));

  // Step1. 本地线程【发送】数据
  var arr = [1, 2, 3];
  myWorker.postMessage(arr);

  // Step4. 本地线程【接受】数据
  myWorker.onmessage = function (e) {
    var data = e.data;
    console.log('page:', data); // page: [1, 2, 3, "hello"]
    console.log('arr:', arr); // arr: [1, 2, 3]
  };


  console.log(11111111);//先打印【不阻塞本地线程】
  setTimeout(() => {
    console.log('setTimeout数据'); //先打印【不阻塞本地线程】
  }, 0);
  //淘宝canvas在用， https://fed.taobao.org/blog/taofed/do71ct/canvas-performance
</script>

</html>