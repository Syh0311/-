<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>手写--call-apply-bind</title>
  </head>
  <body>
    <script>
      // 测试数据
      c = 100000;
      function add(a, b) {
        // console.log(this);
        return a + b + this.c;
      }
      let obj = {
        c: 521,
      };

      //call
      Function.prototype.myCall = function (thisArg, ...args) {
        //thisArg = window 不行
        thisArg = thisArg || window;
        const self = this;
        thisArg.fn = self;
        let res = thisArg.fn(...args);
        delete thisArg.fn;
        return res;
      };
      console.log(add.myCall(obj, 1, 20)); //521+1+20
      console.log(add.myCall(null, 1, 20)); //100000+1+20

      //apply
      Function.prototype.myApply = function (thisArg, args) {
        thisArg = thisArg || window;
        const self = this;
        thisArg.fn = self;
        const res = thisArg.fn(...args);
        delete thisArg.fn;
        return res;
      };
      console.log(add.myApply(obj, [1, 20])); //521+1+20
      console.log(add.myApply(null, [1, 20])); //100000+1+20

      //bind
      Function.prototype.myBind = function (thisArg, ...args1) {
        thisArg = thisArg || window;
        const self = this;
        return function (...args2) {
          thisArg.fn = self;
          const res = thisArg.fn(...args1, ...args2);
          delete thisArg.fn;
          return res;
        };
      };
      let bindFn = add.myBind(obj, 1);
      console.log(bindFn(20)); //521+1+20
      let bindFn2 = add.myBind(null, 1);
      console.log(bindFn2(20)); //100000+1+20
    </script>
  </body>
</html>
