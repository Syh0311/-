

## XSS

### 能干啥

1. 盗取cookie
2. 存储恶意代码到数据库；

### XSS类型

1. 反射型：【恶意代码在URL上，诱导用户点击】
2. 存储型：【恶意代码被存到数据库中，再次读取时体现出来】
3. DOM型：【通过恶意脚本修改页面的 DOM 结构，是纯粹发生在客户端的攻击】

![image-20220225150327119](D:\Sync\typora图片\image-20220225150327119.png)

### XSS防范

1. 对`输入转义`；
2. server端`不相信任何来自client的http请求`；
3. 后端对Cookie设置为`HttpOnly `，防止劫取 Cookie  【设置后JavaScript拿不到cookie】

总之，后端不能相信前端的任何输入。

## CSRF

CSRF（Cross-site request forgery）跨站请求伪造：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。

### 能干啥

1. 不同于XSS，CSRF不盗取cookie，而是利用`浏览器规则`让浏览器自动携带上cookie；
2. 能发送GET和POST请求。

### 攻击流程

一个典型的CSRF攻击有着如下的流程：

1. 受害者登录`taobao.com`，并保留了登录凭证（Cookie）。
2. 攻击者引诱受害者访问了`hacker.com`。
3. `hacker.com 向 taobao.com 发送了一个请求`：taobao.com/act=xx。浏览器会`默认携带taobao.com的Cookie`。
4. taobao.com接收到请求后，对请求进行验证，并确认是受害者的凭证，`误以为`是受害者自己发送的请求。
5. taobao.com`以受害者的名义执行了`act=xx。
6. 攻击完成，攻击者在受害者`不知情的情况`下，冒充受害者，让taobao.com`执行了自己定义的操作`。



### GET和POST

**CSRF攻击分为`GET和POST`两种情况**



**GET**

在【`hacker.com`】中的img、script【等没有跨域限制】上附上要伪造的地址，诱导用户点击`hacker.com`，点击后触发【请求】，浏览器自动携带cookie；



**POST**

在【`hacker.com`】中内嵌【iframe】，iframe内有【post】表单，通过JavaScript获取到iframe表单，执行【submit】操作。

![image-20220320213522384](D:\Sync\typora图片\image-20220320213522384.png)

### CSRF防范

- CSRF自动防御策略：同源检测（Origin 和 Referer 验证）。

  每个HTTP请求都带两个头 Origin Header和Referer Header；这两个Header不能前端自定义；

  

  服务器应该优先检测 Origin；

  因为相比于 Referer，Origin 只包含了域名而不带路径。

- CSRF主动防御措施：Token验证 或者 双重Cookie验证 以及配合Samesite Cookie。

- 保证页面的幂等性，后端接口不要在GET页面中做用户操作。

## 点击劫持

## CDN劫持

## CSP

## 安全沙箱

## 百度贴吧图片



## 参考

1. [前端常见的安全问题及防范措施](https://juejin.cn/post/7067697624626757646)
2. [前端安全系列（一）：如何防止XSS攻击？](https://tech.meituan.com/2018/09/27/fe-security.html)  美团技术团队
3. [前端安全系列（二）：如何防止CSRF攻击？](https://tech.meituan.com/2018/10/11/fe-security-csrf.html)
4. 
